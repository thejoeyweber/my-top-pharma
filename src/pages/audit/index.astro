---
/**
 * Database Audit Dashboard
 * 
 * This page serves as a central navigation point for all database audit views.
 * It provides links to specific entity audits and displays general system health information.
 */
import BaseLayout from '../../components/templates/BaseLayout.astro';
import Card from '../../components/atoms/Card.astro';

// Current timestamp for display
const timestamp = new Date().toLocaleString();

// Define available audit sections
const auditSections = [
  {
    title: 'Companies',
    description: 'View and validate company data, including SEC EDGAR integration',
    path: '/audit/companies',
    icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
    </svg>`,
    available: true
  },
  {
    title: 'Products',
    description: 'Examine product data, including regulatory approvals and therapeutic areas',
    path: '/audit/products',
    icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
    </svg>`,
    available: false
  },
  {
    title: 'Therapeutic Areas',
    description: 'View mappings between therapeutic areas, indications, and products',
    path: '/audit/therapeutic-areas',
    icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-indigo-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 4a2 2 0 114 0v1a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-1a2 2 0 100 4h1a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-1a2 2 0 10-4 0v1a1 1 0 01-1 1H7a1 1 0 01-1-1v-3a1 1 0 00-1-1H4a2 2 0 110-4h1a1 1 0 001-1V7a1 1 0 011-1h3a1 1 0 001-1V4z" />
    </svg>`,
    available: false
  },
  {
    title: 'S3 Data Lake',
    description: 'Explore raw data files and crawled content in the data lake',
    path: '/audit/data-lake',
    icon: `<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-purple-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4" />
    </svg>`,
    available: false
  }
];
---

<BaseLayout title="Database Audit Dashboard">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
    <h1 class="text-3xl font-bold mb-2">Database Audit Dashboard</h1>
    <p class="text-gray-600 mb-8">A central location to view and validate data across all entities in the system.</p>
    
    <div class="mb-2 text-sm text-gray-500">
      Last updated: {timestamp}
    </div>
    
    <!-- Audit Sections Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
      {auditSections.map((section) => (
        <div class={`rounded-lg border p-6 ${section.available ? 'bg-white hover:shadow-md transition-shadow' : 'bg-gray-50 opacity-75'}`}>
          <div class="flex items-start space-x-4">
            <div class="flex-shrink-0" set:html={section.icon} />
            <div>
              <h3 class="text-xl font-semibold mb-2">{section.title}</h3>
              <p class="text-gray-600 text-sm mb-4">{section.description}</p>
              {section.available ? (
                <a href={section.path} class="inline-flex items-center justify-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                  View Audit
                </a>
              ) : (
                <span class="inline-flex items-center px-4 py-2 bg-gray-200 text-gray-500 text-sm font-medium rounded-md">
                  Coming Soon
                </span>
              )}
            </div>
          </div>
        </div>
      ))}
    </div>
    
    <!-- About Database Audit Section -->
    <div class="bg-white rounded-lg border p-6 mb-8">
      <h2 class="text-2xl font-bold mb-4">About Database Audit</h2>
      <div class="prose max-w-none">
        <p>
          The Database Audit pages provide direct access to raw data stored in the database for validation, debugging, and quality assessment purposes. 
          These pages are intended for administrators and data stewards to:
        </p>
        <ul class="list-disc pl-5 mt-2 mb-4">
          <li>Verify data integrity and completeness</li>
          <li>Identify and fix data quality issues</li>
          <li>Validate data ingestion from external sources like SEC EDGAR</li>
          <li>Ensure proper data relationships between entities</li>
        </ul>
        <p>
          The audit pages provide both visual inspection capabilities and tools to trigger data updates or corrections.
        </p>
      </div>
    </div>
  </div>
</BaseLayout> 